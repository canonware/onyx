/******************************************************************************
 *
 * <Copyright = jasone>
 * <License>
 *
 ******************************************************************************
 *
 * Version: Onyx <Version = onyx>
 *
 * Cookfile for modgtk.
 *
 ******************************************************************************/

/* Include generated dependency files. */
#include-cooked [glob @objroot@/mod/modgtk/src/"*.d_*"]

/*
 * File lists.
 */

/* Source files. */
MODGTK_SRCS = [addprefix @srcroot@/mod/modgtk/src/
                         modgtk.c
                         ];

/* Generated source code (created by configure). */
MODGTK_NX_GEN = [fromto %.nx.in @objroot@/mod/modgtk/nx/modgtk/%.nx
                        modgtk_defs.nx.in
                        ];

MODGTK_NX = [addprefix @srcroot@/mod/modgtk/nx/modgtk/
                       modgtk.nx
                       ];

/* Modules. */
MODGTK = @objroot@/mod/modgtk/nxm/modgtk.nxm;

/*
 * User cook'ables.
 */

modgtk : [MODGTK];

modgtk_mods_tests :
{

}

modgtk_mods_check :
{

}

modgtk_mods_check_update :
{

}

modgtk_mods_install : [MODGTK]
{
  @INSTALL@ -d [PREFIX]/share/onyx-@onyx_version@/nxm;
  @INSTALL@ -m 0444 [MODGTK] [PREFIX]/share/onyx-@onyx_version@/nxm;
  @INSTALL@ -d [PREFIX]/share/onyx-@onyx_version@/nx/modgtk;

  loop local f = [MODGTK_NX] [MODGTK_NX_GEN]
  {
    @INSTALL@ -m 0644 [f] [PREFIX]/share/onyx-@onyx_version@/nx/modgtk/;
  }
}

modgtk_mods_uninstall :
{
  rm -f [PREFIX]/share/onyx-@onyx_version@/nxm/modgtk.nxm;
  rm -rf [PREFIX]/share/onyx-@onyx_version@/nx/modgtk;
}

modgtk_mods_clean :
{
  rm -f [fromto @srcroot@/%0%.c @objroot@/%0%.d_s [MODGTK_SRCS]];
  rm -f [fromto @srcroot@/%0%.c @objroot@/%0%.o_s [MODGTK_SRCS]];
  rm -f [MODGTK];
}

modgtk_mods_distclean :
{
}

/*
 * Various flags.
 */
MODGTK_CPPFLAGS = @GTK_CFLAGS@;
MODGTK_LDFLAGS = @GTK_LIBS@;

CPPFLAGS = [CPPFLAGS] -I@srcroot@/mod/modgtk/include
                      -I@objroot@/mod/modgtk/include
                      [MODGTK_CPPFLAGS];

/*
 * Dependencies.
 */

[MODGTK] : [fromto @srcroot@/%0%.c @objroot@/%0%.o_s [MODGTK_SRCS]]
  set mkdir
{
  [CC]
#if [matches elf @abi@]
       -shared
#elif [matches macho @abi@]
       -undefined suppress -flat_namespace -bundle -all_load
#endif
       -o [target] [need] [MODGTK_LDFLAGS];
}
