/******************************************************************************
 *
 * <Copyright = jasone>
 * <License>
 *
 ******************************************************************************
 *
 * Version: Onyx <Version = onyx>
 *
 * Cookfile for modgtk.
 *
 ******************************************************************************/

/* Include generated dependency files. */
#include-cooked [glob [objdir]/mod/modgtk/src/"*.d_*"]

/*
 * File lists.
 */

/* Source files. */
MODGTK_MSRCS = modgtk.c;

MODGTK_MSRCS = [fromto % [srcdir]/mod/modgtk/src/% [MODGTK_MSRCS]];

/* Generated source code (created by configure). */
MODGTK_NX_GEN = modgtk_defs.nx.in;
MODGTK_NX_GEN = [fromto %.nx.in [objdir]/mod/modgtk/nx/modgtk/%.nx
                        [MODGTK_NX_GEN]];

MODGTK_NX = modgtk.nx;
MODGTK_NX = [fromto % [srcdir]/mod/modgtk/nx/modgtk/% [MODGTK_NX]];

/* Modules. */
MODGTK = [objdir]/mod/modgtk/nxm/modgtk.nxm;

/*
 * User cook'ables.
 */

modgtk : [MODGTK];

modgtk_mods_install : [MODGTK]
{
  [SHELL] -e;
data
#![SHELL]

echo [INSTALL] -d [PREFIX]/share/onyx/nxm
[INSTALL] -d [PREFIX]/share/onyx/nxm

echo [INSTALL] -m 0444 [MODGTK] [PREFIX]/share/onyx/nxm
[INSTALL] -m 0444 [MODGTK] [PREFIX]/share/onyx/nxm

echo [INSTALL] -d [PREFIX]/share/onyx/nx/modgtk
[INSTALL] -d [PREFIX]/share/onyx/nx/modgtk

for i in [MODGTK_NX] [MODGTK_NX_GEN]; do
	echo [INSTALL] -m 0644 $i [PREFIX]/share/onyx/nx/modgtk/
	[INSTALL] -m 0644 $i [PREFIX]/share/onyx/nx/modgtk/
done
dataend
}

modgtk_mods_uninstall :
{
  rm -f [PREFIX]/share/onyx/nxm/modgtk.nxm;
  rm -rf [PREFIX]/share/onyx/nx/modgtk/;
}

modgtk_mods_clean :
{
}

modgtk_mods_distclean :
{
}

/*
 * Various flags.
 */
MODGTK_CPPFLAGS = @GTK_CFLAGS@;
MODGTK_LDFLAGS = @GTK_LIBS@;

CPPFLAGS = [CPPFLAGS] -I[srcdir]/mod/modgtk/include
                      -I[objdir]/mod/modgtk/include
                      [MODGTK_CPPFLAGS];

/*
 * Dependencies.
 */

[MODGTK] : [fromto [srcdir]/%0%.c [objdir]/%0%.o_s [MODGTK_MSRCS]]
  set mkdir
{
  [CC]
#if [matches elf [abi]]
       -shared
#elif [matches macho [abi]]
       -undefined suppress -flat_namespace -bundle -all_load
#endif
       -o [target] [need] [MODGTK_LDFLAGS];
}
