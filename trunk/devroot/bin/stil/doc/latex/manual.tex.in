%-*-mode:latex-*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% <Copyright = jasone>
% <License>
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Version: <Version>
%
% stil portion of Canonware Software Manual.
%              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearemptydoublepage
\chapter{stil}
\binname{stil} is a stand-alone stil interpreter, with an integrated command
line editor and the ability to handle \#! magic.  The stil language is
documented in a separate \htmlref{chapter}{stillang}, so this chapter documents
only the differences from the main stil language documentation.

\section{Usage}
\binname{stil} -h

\binname{stil} -V

\binname{stil} -e {\lt}expr{\gt}

\binname{stil} {\lt}file{\gt} [{\lt}args{\gt}]

\subsection{Options}
\begin{description}
\item[-e {\lt}expr{\gt}: ] Execute {\lt}expr{\gt} as stil code.
\item[-h: ] Display usage information and exit.
\item[-V: ] Display the version number and exit.
\end{description}

\section{Environment variables}
\begin{description}
\item[STIL\_EDITOR: ] By default, the command line editor uses emacs key
bindings.  Use this variable to explicitly set the key bindings to either emacs
or vi.
\end{description}

\section{Language differences}
If \binname{stil} is being run interactively:
\begin{itemize}
\item{The promptstring operator is defined in the initial thread's userdict to
print the number of objects on the operand stack.}
\item{The stop operator in currenterror is redefined to the empty procedure in
order to keep the interpreter from exiting on error.}
\item{The estackoverflow operator in errordict is redefined to call the quit
operator in order to avoid infinite recursion in the error handling machinery.
The need for this is a result of not exiting on error.}
\end{itemize}

If \binname{stil} is not being run interactively:
\begin{itemize}
\item{\#! is defined in the initial thread's userdict to push a mark object on
the operand stack.}
\item{!\# is defined in the initial thread's userdict to call the cleartomark
operator.}
\end{itemize}

In order to cleanly use \#! magic, the header of a stil script should look like:
\begin{verbatim}
#!/usr/local/bin/stil
!#
% Code...
\end{verbatim}

If the !\# is omitted, a mark and some name objects will be left on the operand
stack.
