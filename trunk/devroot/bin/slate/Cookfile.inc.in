/******************************************************************************
 *
 * <Copyright = jasone>
 * <License>
 *
 ******************************************************************************
 *
 * Version: Slate <Version = slate>
 *
 * Cookfile for slate.
 *
 ******************************************************************************/

/* Include generated dependency files. */
#include-cooked [glob @objroot@/bin/slate/src/"*.d_*"]

/*
 * File lists.
 */

TSLATE_SRCS = tslate.c;
TSLATE_SRCS = [addprefix @srcroot@/bin/slate/src/ [TSLATE_SRCS]];

/* Source file. */
SLATE_NSRCS = @srcroot@/bin/slate/src/slate.nx.in.in;

/* LaTeX source files. */
SLATE_TEX_SRCS = ;
SLATE_TEX_SRCS = [addprefix @srcroot@/bin/slate/doc/latex/ [SLATE_TEX_SRCS]];
/* SLATE_TEX_SRCS = [SLATE_TEX_SRCS] @objroot@/bin/slate/doc/latex/manual.tex; */

/* Binaries. */
SLATE = @objroot@/bin/slate/bin/slate;
TSLATE = @objroot@/bin/slate/bin/tslate;


/*
 * User cook'ables.
 */

tslate : [TSLATE];
slate : [SLATE];

slate_bins_tests :
{
}

slate_bins_check :
{
}

slate_bins_check_update :
{
}

slate_bins_bootstrap :
{
}

slate_bins_install : mods_install
#if @enable_onyx@
                     onyx_bins_install
#endif
{
  @INSTALL@ -d [PREFIX]/bin;

  echo \"#!@ONYX@\" > [PREFIX]/bin/slate-@slate_version@;
  echo \"!#\" >> [PREFIX]/bin/slate-@slate_version@;
  cat [fromto @srcroot@/%0%.nx.in.in @objroot@/%0%.nx.in [SLATE_NSRCS]]
      >> [PREFIX]/bin/slate-@slate_version@;
  chmod 0755 [PREFIX]/bin/slate-@slate_version@;

  rm -f [PREFIX]/bin/slate;
  ln -s slate-@slate_version@ [PREFIX]/bin/slate;

  @INSTALL@ -d [PREFIX]/man/man1;
  @INSTALL@ -m 0444 @objroot@/bin/slate/man/man1/slate.1 [PREFIX]/man/man1;

  @INSTALL@ -d [PREFIX]/share;
  rm -f [PREFIX]/share/slate;
  ln -s slate-@slate_version@ [PREFIX]/share/slate;
}

slate_bins_uninstall :
{
  rm -f [PREFIX]/bin/slate-@slate_version@;
  rm -f [PREFIX]/bin/slate;
  rm -f [PREFIX]/man/man1/slate.1;
  rm -f [PREFIX]/share/slate;
}

slate_bins_clean :
{
  rm -f [fromto @srcroot@/%0%.c @objroot@/%0%.d_a
                [ONYX_COMMON_SRCS] [BONYX_ONLY_SRCS] [TSLATE_SRCS]];
  rm -f [fromto @srcroot@/%0%.c @objroot@/%0%.o_a
                [ONYX_COMMON_SRCS] [BONYX_ONLY_SRCS] [TSLATE_SRCS]];

  rm -f [SLATE] [TSLATE];
}

slate_bins_distclean :
{
  rm -f [fromto @srcroot@/%0%.nx.in.in @objroot@/%0%.nx.in [SLATE_NSRCS]];
}

/*
 * Dependencies.
 */

[TSLATE] : [fromto @srcroot@/%0%.c @objroot@/%0%.o_a [TSLATE_SRCS]]
           [SLATE]
  set mkdir
{
  [CC] [A_CFLAGS] -o [target]
       [fromto @srcroot@/%0%.c @objroot@/%0%.o_a [TSLATE_SRCS]];
}

[SLATE] : [fromto @srcroot@/%0%.nx.in.in @objroot@/%0%.nx.in [SLATE_NSRCS]] mods
#if @enable_onyx@
          tonyx
#endif
  set mkdir
{
  echo \"#!@TONYX@\" > [target];
  echo \"!#\" >> [target];
  cat [fromto @srcroot@/%0%.nx.in.in @objroot@/%0%.nx.in [SLATE_NSRCS]]
      >> [target];
  chmod 0755 [target];
}
